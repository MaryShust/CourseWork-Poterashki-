# Отчет по второму этапу курсовой работы

Из-за особенностей микросервисной архитектуры, несмотря на наличие связей между сущностями, как таковой связи между таблицами не будет.
Из-за таких ограничений, для связи между базами будут использоваться "сквозные" id-шники, которые будут обеспечивать целостность данных в системе, но не в каждой отдельной базе.

### Маркеры для таблиц
| Цвет | Сервис |
| -- | -- |
| Красный | уведомлений |
| Фиолетовый | авторизации |
| зеленый | задач |
| синий | сервис поиска |

## ER модель
> Если плохо видно - вот [ссылка](https://drive.google.com/file/d/1UuftfjahilDOuCXTRAh5qHDrKTnoQyUc/view?usp=sharing)
<img width="1024" height="700" alt="image" src="https://github.com/user-attachments/assets/88b72727-eb86-4b9b-9871-c4a9246e9a84" />

## Даталогическая модель
> Если плохо видно - вот [ссылка](https://drive.google.com/file/d/1IyfdXJtSaLUxwE0USxw9yIKpjBbqroBy/view?usp=sharing)
<img width="846" height="700" alt="image" src="https://github.com/user-attachments/assets/456ffa25-4182-4f69-84dd-bd7722d503f5" />

## Процедуры и триггеры
Мне кажется более разумным обеспечивать контроль на уровне приложения, и не дублировать на уровень данных. Кроме того, большинство триггеров работает в рамках одной базы, а у нас тут необходимо обеспечить целостность в рамках нескольких баз
* При миграциях бд будет проще
* Нет дублирования ограничений
* Fail fast архитектура более удобна, поскольку бизнес-логика работает с "корректными" данными без необходимости дополнительно проверки на валидность

## Индексы
К реализации предлагаются следующие индексы
| Тип | Колонка | Польза |
|--|--|--|
| hash | user.id | Поиск пользователя по id - основная операция для операция для таблицы user |
| hash | contact.userId | Поиск всех способов контакта для пользователя c id = ... - будет наиболее частой операцией |
| hash | photo.entity | Выборка всех картинок для сущности - наиболее частая операция |
| hash | place.entity | Поиск места для сущности - целевая операция |
| hash | lost.id | По сути индексом для lost будет elasticSearch.  Поэтому поиск в таблице будет только по id |
| hash | found.id | По сути индексом для found будет elasticSearch. Поэтому поиск в таблице будет только по id |
